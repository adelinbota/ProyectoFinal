<body>
  <div class="container col-12 mt-5" *ngIf="usuarioLogueado && usuarioLogueado.idTipoUsuario == 1">
    <h1 class="col-12 text-center mt-5">Citas</h1>
    <div class="col-12">
      <div class="row">
        <div class="col-6">
          <a routerLink="/citas/add-citas" class="btn btn-outline-primary mt-5 mb-3 col-4">Nueva cita</a>
        </div>
      </div>
    </div>
    <div class="table-responsive mt-3">
      <table class="table">
        <thead>
          <tr>
            <th scope="col">Fecha Cita</th>
            <th scope="col">Observaciones</th>
            <th scope="col">Usuario</th>
            <th scope="col">Servicio</th>
            <th scope="col">Acciones</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let cita of citas | async">
            <td scope="row"><b>{{cita.fechaCita.split('-')[2]}}/{{cita.fechaCita.split('-')[1]}}</b>
              {{cita.horaCita.slice(0,5)}} - {{cita.horaFin.slice(0,5)}}</td>
            <td>{{cita.comentarios}}</td>
            <td>{{cita.nombreUsuario}}</td>
            <td>{{cita.nombreServicio}}</td>
            <td>
              <button type="button" routerLink="/citas/actualizar-citas/{{cita.idCita}}"
                class="btn btn-outline-success btn-sm">Editar</button>
              <button type="button" class="btn btn-outline-danger btn-sm"
                (click)="abrirModal(contenido, cita)">Eliminar</button>
            </td>
          </tr>
        </tbody>
        <ng-template #contenido let-modal let-cita="citaSeleccionada">
          <div class="modal-header">
            <h4 class="modal-title text-center">Eliminar cita</h4>
            <button type="button" class="close" aria-label="Close" (click)="modal.dismiss()">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <p class="text-center mb-4">¿Estás seguro que deseas eliminar la siguiente cita?</p>
            <div class="card mb-3 card-margen">
              <div class="row g-0">
                <div class="col-md-8">
                  <div class="card-body">
                    <p class="card-title">{{ citaSeleccionada.nombreUsuario}}</p>
                    <p class="card-text">
                      {{citaSeleccionada.fechaCita.split('-')[2]}}/{{citaSeleccionada.fechaCita.split('-')[1]}}
                      {{citaSeleccionada.horaCita.slice(0,5)}}</p>
                    <p class="card-text">{{citaSeleccionada.nombreServicio}}</p>
                    <p class="card-text"><small class="text-muted">{{citaSeleccionada.comentarios}}</small></p>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" (click)="modal.dismiss()">Cancelar</button>
            <button type="button" class="btn btn-danger"
              (click)="eliminarCita(citaSeleccionada); modal.close()">Eliminar</button>
          </div>
        </ng-template>
      </table>
    </div>
  </div>
  <div class="container col-5 mt-5 mb-5" *ngIf="usuarioLogueado && usuarioLogueado.idTipoUsuario == 2">
    <h1 class="text-center">Mis Citas</h1>
    <div class="text-center">
      <button class="btn btn-success mt-3" routerLink="new">Nueva cita</button>
    </div>
    <div class="card text-center" *ngFor="let cita of citasUsuario">
      <div class="card-header">
        <h2 class="mb-0">Cita Reservada</h2>
        <p class="mb-0">{{formatear(cita.fechaCita)}} {{cita.horaCita.slice(0,5)}}</p>
      </div>
      <div class="card-body">
        <h3 class="card-title">{{cita.idUsuario}}</h3>
        <p class="card-text">{{cita.idServicio}}</p>
        <p class="card-text">Peluquera: Maria Costin</p>
        <p class="card-text">Dirección: Calle Barcelona, 53</p>
        <button class="btn btn-primary mt-3">Ver detalles</button>
      </div>
    </div>
  </div>
  <div class="container col-12 mt-5" *ngIf="!usuarioLogueado">
    <div class="text-center">
      <h1 class="display-4">Accede para obtener una cita</h1>
      <p class="lead">Para disfrutar de nuestros servicios, primero debes iniciar sesión.</p>
      <p class="lead">Haz clic <a routerLink="/login">aquí</a> para iniciar sesión.</p>
    </div>
    <hr class="my-5">
    <div class="text-center mt-5">
      <h1 class="display-4">Servicios</h1>
      <p class="lead">Explora nuestra selección de servicios disponibles.</p>
      <p class="lead">Haz clic <a routerLink="/servicios">aquí</a> para ver nuestros servicios.</p>
    </div>
    <hr class="my-5">
    <div class="text-center mt-5">
      <h1 class="display-4">Contactos</h1>
      <p class="lead">Si deseas contactar con nuestra empresa o realizar una valoración, estaremos encantados de recibir
        tus comentarios.</p>
      <p class="lead">Haz clic <a routerLink="/contacto">aquí</a> para acceder a nuestra página de contactos.</p>
    </div>

  </div>

  <app-footer></app-footer>
</body>